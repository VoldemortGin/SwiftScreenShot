# 截图历史功能说明

## 功能概述

截图历史功能可以自动保存最近的截图，方便随时查看、复制、编辑和管理历史截图。

## 主要功能

### 1. 自动保存
- 每次截图自动保存到历史记录
- 支持设置保存数量上限（10/20/50张）
- 生成缩略图以提高性能
- 固定的截图不受数量限制

### 2. 历史窗口
- 网格式缩略图展示
- 鼠标悬停显示操作按钮
- 支持搜索和筛选

### 3. 操作功能

#### 预览
- 点击缩略图或预览按钮查看完整图片
- 支持滚动查看大图

#### 复制到剪贴板
- 快速复制历史截图到剪贴板
- 自动显示复制成功提示

#### 重新编辑
- 打开编辑器重新编辑历史截图
- 支持添加箭头、文字、马赛克等

#### 固定/取消固定
- 固定重要截图，不受数量限制影响
- 固定的截图显示橙色标记

#### 删除单张
- 删除不需要的截图
- 同时删除原图和缩略图

#### 清空历史
- 仅删除未固定：保留固定的截图
- 全部删除：��空所有历史

### 4. 搜索和筛选

#### 按格式搜索
- 在搜索框输入格式（如 "png", "jpg"）

#### 按日期筛选
- 今天
- 昨天
- 最近7天
- 最近30天

## 快捷键

- **打开历史窗口**: ⌘H (Command + H)

## 设置选项

在设置窗口中可以配置：

### 自动保存到历史
- 开启/关闭自动保存功能
- 默认：开启

### 历史数量上限
- 10张
- 20张（默认）
- 50张
- 注：固定的截图不受此限制

### 存储位置
- 默认位置：`~/Library/Application Support/SwiftScreenShot/History`
- 可自定义存储路径
- 点击"重置"恢复默认位置

## 存储结构

```
History/
├── Images/           # 完整截图
│   ├── screenshot_20231214_153020_123.png
│   └── ...
├── Thumbnails/       # 缩略图 (200x200)
│   ├── thumb_20231214_153020_123.png
│   └── ...
└── index.json        # 历史索引文件
```

## 性能优化

1. **缩略图**：200x200 分辨率，加快加载速度
2. **延迟加载**：完整图片仅在预览时加载
3. **自动清理**：超过上限自动删除最旧的未固定截图
4. **轻量索引**：使用 JSON 文件快速加载历史列表

## 数据管理

### 备份历史
复制整个 History 文件夹即可备份所有历史截图和索引

### 迁移历史
1. 在设置中选择新的存储位置
2. 手动复制旧位置的 History 文件夹内容到新位置
3. 重启应用

### 清理空间
- 使用"清空历史"功能
- 或手动删除 History 文件夹

## 注意事项

1. **权限**：确保应用有权限访问自定义存储路径
2. **空间**：历史截图会占用磁盘空间，建议定期清理
3. **格式**：历史保存使用截图时的原始格式
4. **同步**：历史数据仅保存在本地，不支持云同步

## 使用技巧

1. **固定重要截图**：对重要截图使用固定功能，避免被自动清理
2. **按日期筛选**：快速找到某个时间段的截图
3. **快速复制**：无需打开编辑器，直接从历史复制到剪贴板
4. **二次编辑**：对历史截图重新编辑，而不是重新截图

## 故障排除

### 历史不显示
- 检查设置中是否开启"自动保存到历史"
- 确认存储位置有写入权限

### 缩略图不显示
- 可能是缩略图文件损坏，删除 Thumbnails 文件夹后会自动重新生成

### 历史数据丢失
- 检查是否更改了存储位置
- 查看旧位置的 History 文件夹是否还存在

### 占用空间过大
- 降低历史数量上限
- 定期清空历史
- 考虑只保存必要的截图
